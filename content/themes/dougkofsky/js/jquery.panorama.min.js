(function(c){function b(f,h){var U=this;var u=jQuery.extend({},{size:false,speed:20,move:200,gravity:400,wheel:1,drag:1,attenuation:4,fade:400,fps:60},h);var t=0;var z=0;var P;var F;var s;var T=0;var B;var X;var W;var V;var d;var p=false;var e=-1;var ac=-1;var aa;var D=false;var r;var n=null;var N=0;var M;var i=true;var ad=false;var o,H;if(typeof Date.now=="undefined"){Date.now=function(){return new Date().getTime()}}var A=Date.now();var C=function(){V=false;X=new Array();var ae=f.css("backgroundImage");var ag=f.find(".panorama_titel").css("position","relative").remove();var af=f.find(".panorama_preloader").css("position","relative").remove();ag.find("img").bind("dragstart",function(ah){ah.preventDefault()});f.find("img").each(function(){if(this.src){X.push({path:this.src});this.src=""}else{if(c(this).data("src")){X.push({path:c(this).data("src")})}}});J();f.css({overflow:"hidden",position:"relative",padding:"0px",backgroundImage:"none"});if(u.size===true){f.css({position:"fixed",margin:"0px",width:"100%",top:"0px",left:"0px"})}B=c("<div></div>").css({overflow:"hidden",top:"0px",left:"0px",position:"absolute",padding:"0px",margin:"0px"});f.empty().append(B,af);c('<div class="panorama_pattern"></div>').css({width:"100%",height:"100%","background-image":ae,position:"absolute",top:"0px",left:"0px",padding:"0px",margin:"0px"}).appendTo(f);f.append(ag);n=("ontouchstart" in document.documentElement)?true:false;if(n){u.fade=false}Y();d=t;c(window).resize(function(){ab(false);y();clearTimeout(aa);aa=setTimeout(l,100)});l();V=true};var l=function(){if(u.size===true){var af=parseFloat(f.css("borderWidth"))*2;if(isNaN(af)||!af){af=0}s=c(window).height()-af;F=c(window).width()-af;f.height(s);f.width(F);I()}else{if(u.size<0){F=f.width();var ae=-u.size;if(s!=ae){s=ae;f.height(s);I()}}else{if(u.size>0){F=f.width();var ae=F/u.size;if(s!=ae){s=ae;f.height(s);I()}}else{F=f.width()}}}v(1,false);if(V){ab();G()}};var q=function(){if(!n){f.unbind("mousedown mouseup mouseleave mousemove mousewheel DOMMouseScroll MozMousePixelScroll wheel scroll",L);if(u.drag){f.bind("mousedown",L)}if(u.wheel){f.bind("mousewheel DOMMouseScroll MozMousePixelScroll wheel",L)}if(u.move||u.drag){f.bind("mousemove mouseleave",L);j(true)}}else{f.unbind("touchstart touchend touchmove",L);if(u.drag||u.move){f.bind("touchstart touchend touchmove",L)}ab()}};var ab=function(ae){var af=false;if(window.DeviceOrientationEvent){af="deviceorientation"}else{if(window.OrientationEvent){af="MozOrientation"}}if(af){window.removeEventListener(af,L,false);if(u.gravity&&ae!==false){window.addEventListener(af,L,false)}}};var j=function(ae){if(document.addEventListener){if(ae){document.addEventListener("mouseout",L,false)}else{document.removeEventListener("mouseout",L,false)}}else{if(document.attachEvent){if(ae){document.attachEvent("onmouseout",L)}else{document.detachEvent("onmouseout",L)}}}};var L=function(ai){ai=ai?ai:window.event;switch(ai.type){case"mousemove":var aj=Date.now();if(A+M>aj&&!D){return}case"touchmove":i=false;var af=S(ai);if(D){t=(af-r)*u.drag;r=af;if((u.drag&&ai.type=="mousemove")||ai.type=="touchmove"){if(g(t,true)){k()}}}else{if(u.move){var ah=c("html").scrollLeft();if(!ah){ah=c("body").scrollLeft()}af+=-f.offset().left+ah;d=(2*af/F-1)*u.move/u.fps;G()}}O(t);A=aj;break;case"mousewheel":case"MozMousePixelScroll":case"wheel":case"DOMMouseScroll":if(!ai.detail&&!ai.wheelDelta){ai=ai.originalEvent}var ag=ai.wheelDelta||-ai.detail;if(!ag){break}ag=Math.abs(u.wheel)*((u.wheel*ag>0)?1000:-1000)/u.fps;if(t*ag>0){t+=ag/3}else{t=ag/3}t=Z(t,Math.abs(u.wheel)*1000/u.fps);d=(t>0?1:-1)*Math.abs(u.speed)/u.fps;A=Date.now()+1000;i=true;G();if(ai.preventDefault){ai.preventDefault()}ai.returnValue=false;break;case"touchstart":case"mousedown":t=0;d=0;y();D=true;r=S(ai);if(ai.type=="mousedown"){f.unbind("mouseup mousemove",L).bind("mouseup mousemove",L).css("cursor","move")}A=Date.now()-500;break;case"mouseout":case"onmouseout":var ae=ai.relatedTarget||ai.toElement;if(!ae||ae.nodeName=="HTML"){}else{return}case"mouseleave":d=(t>0?1:-1)*Math.abs(u.speed)/u.fps;case"touchend":case"mouseup":if(ai.type=="mouseup"||ai.type=="mouseleave"){f.unbind("mouseup mousemove",L).css("cursor","auto");if(u.move){f.bind("mousemove",L)}}D=false;i=true;if(t!=0){G()}else{if(ai.type=="mouseup"){d=t}}if(ai.type=="mouseup"||ai.type=="touchend"){A=Date.now()+1000}break;case"MozOrientation":ai.gamma=eventData.x*90;ai.beta=-eventData.y*90;case"deviceorientation":if(A+M*3>Date.now()||D){return}i=false;var af=0;switch(window.orientation){case 90:af=Math.max(-0.5,Math.min(0.5,ai.beta/90));break;case -90:af=-Math.max(-0.5,Math.min(0.5,ai.beta/90));break;case 180:af=Math.max(-0.5,Math.min(0.5,ai.gamma/90));break;case 0:default:if(ai.gamma<-90||ai.gamma>90){ai.gamma=Math.abs(ai.gamma)/ai.gamma*(180-Math.abs(ai.gamma))}af=Math.max(-45,Math.min(45,ai.gamma))/90;break}if(Math.abs(af)<0.033){i=true;d=t;if(t==0){y()}return}d=2*af*u.gravity/u.fps;G();A=Date.now();break}};var S=function(ae){if(n){if(ae.type!="touchstart"){ae.preventDefault()}var af=ae.originalEvent.touches[0]||ae.originalEvent.changedTouches[0];return af.pageX}else{return ae.clientX}};var K=function(){F=f.width();var af=Math.abs(t)*u.fps;if(af<1&&t==d){t=0;d=0;y()}if(i){var ae=Math.abs(u.speed);if(af!=ae){t*=(1+(af<ae?1:-1)*u.attenuation/u.fps);if((af<ae&&u.fps*Math.abs(t)>ae)||(af>ae&&u.fps*Math.abs(t)<ae)){t=Z(t,ae/u.fps);i=false}O(t)}else{i=false}}else{if(t!=d){t-=Math.min(1,8/u.fps)*(t-d);if(Math.abs(t-d)*u.fps<1){t=d}}}if(g(t,true)){k()}};var g=function(ae,ag){if(ag){ae+=z;z=ae-Math.round(ae);if(Math.abs(Math.round(ae))<1){return false}var af=B[0].style.left;ae+=parseFloat(af)}B[0].style.left=Math.round(ae)+"px";return true};var G=function(){Q();if(e==-1){e=setInterval(K,M)}};var y=function(){clearInterval(e);e=-1};var Q=function(){if(ac!=-1){clearTimeout(ac);ac=-1}};var v=function(af,ag){if(W){return}if(X.length==0){y();return}var ah=0;if(af>0){if(parseFloat(B[0].style.left)+T-F>P){return}else{if(B[0].lastChild){ah=c(B[0].lastChild).data("index");ah=x(ah,1)}}}else{if(-parseFloat(B[0].style.left)>P){return}else{if(B[0].firstChild){ah=c(B[0].firstChild).data("index");ah=x(ah,-1)}}}if(X[ah].img){var ae=(X[ah].img).clone(true).attr("src",X[ah].path);if(af>0){B.append(ae)}else{B.prepend(ae)}if(u.size){I(ae[0])}else{T+=ae[0].width;B.width(T)}if(af<0){g(-ae[0].width,true)}w(ae,ag,af);v(af,ag);return}var ae=c("<img>").bind("dragstart",function(ai){ai.preventDefault()}).css({"float":"left",padding:"0px",margin:"0px","vertical-align":"top",top:"0px","border:":"0","border-style":"none"}).data("index",ah);X[ah].img=ae.clone(true);W=true;ae.error(function(){X.splice(ah,1);W=false;v(af,ag)}).one("load",function(){var ai=c(this);if(af>0){B.append(ai)}else{B.prepend(ai)}I(this);w(ai,ag,af);if(af<0){g(-this.width,true)}if(!p){f.find(".panorama_preloader").remove();p=true;q();G()}W=false;v(af,ag)}).attr("src",X[ah].path).each(function(){var ai=c(this);if(this.complete&&this.width>0&&this.height>0){ai.trigger("load")}})};var x=function(ae,af){if(af>0){return(ae>=X.length-1)?0:(ae+1)}else{return(ae<=0)?(X.length-1):(ae-1)}};var Z=function(ae,af){if(Math.abs(ae)>Math.abs(af)){ae=(ae<0?-1:1)*af}return ae};var R=function(){var ae=0;B.children("img").each(function(){ae+=this.width});return ae};var I=function(ah){if(u.size){if(!s){return}if(typeof ah=="undefined"){var ag=B.find("img");T=0}else{var ag=c(ah)}if(!ag.length){return}var ae=1;ag.each(function(){if(this.height){var ai=s/this.height;ae=Math.min(ae,ai);this.width=this.width*ai;T+=this.width}});if(typeof ah=="undefined"){var af=parseInt(B[0].style.left)*ae;g(af,false)}B.width(T);return}if(typeof s=="undefined"){s=ah.height;if(typeof ah!="undefined"){T+=ah.width;B.width(T)}f.height(s);return}s=Math.min(s,ah.height);if(f.height()!=s){f.animate({height:s},300)}};var k=function(){var ae=parseFloat(B[0].style.left);if(t<0){var af=B[0].firstChild;if(af.width<-ae){g(af.width,true);c(af).remove();T=R();B.width(T)}if(ae+T-F<P){v(1,false)}}else{if(t>0){var ag=B[0].lastChild;if(ae-ag.width+T>F){c(ag).remove();T=R();B.width(T)}if(-ae<P){v(-1,false)}}}};var w=function(ae,af,ag){if(af||u.fade<=0||!m(ae[0],ag)){ae.show()}else{ae.hide().fadeIn(u.fade,function(){if(typeof jQuery.browser=="obgect"){if(jQuery.browser.msie){ae[0].style.removeAttribute("filter")}}})}};var m=function(ag,ah){var af=T-ag.width;var ae=parseInt(B[0].style.left);if(ae+af>F){return false}if(ah>0){return true}if(ae+ag.width<0){return false}return true};var E=function(af){if(typeof af=="string"){var ae=af.toLowerCase();if(ae==String("false")||ae==String("no")){return false}if(ae==String("true")||ae==String("fullscreen")){return true}if(ae.indexOf("px")===-1){return false}ae=parseInt(ae);if(isNaN(ae)){return false}return -ae}var ag=parseFloat(af);if(isNaN(ag)==false){return ag}return af};var J=function(){for(var ae in u){u[ae]=E(u[ae])}if(u.fps<1){u.fps=1}if(u.fadein<0){u.fadein=0}if(u.attenuation<0){u.attenuation=0}if(typeof u.size=="string"){u.size=false}else{if(u.size!==true&&u.size!==false){u.size=(u.size==0)?false:(u.size)}}};var Y=function(){M=Math.round(1000/u.fps);t=-u.speed/u.fps;O(u.speed)};var O=function(ae){P=Math.max(200,Math.abs(ae*2))};this.option=function(ag,af){if(typeof ag!="undefined"){ag=ag.replace(/^\s+|\s+$/g,"");if(typeof u[ag]==="undefined"){return f}if(typeof af=="undefined"){return u[ag]}var ae=u[ag];if(typeof af=="string"){af=af.replace(/^\s+|\s+$/g,"");u[ag]=E(af)}else{if(typeof af=="boolean"||typeof af=="number"||typeof af=="function"){u[ag]=af}}if(ae===u[ag]||ag=="size"){return}J();if(ag=="fps"||ag=="speed"){Y();if(ag=="speed"){d=t}y();G()}else{if(ag=="move"||ag=="wheel"||ag=="drag"){q()}else{if(ag=="gravity"){ab()}}}}};this.pause=function(ae){if(e!=-1){y();if(ae>0){Q();ac=setTimeout(G,ae)}}};this.play=function(ae){if(!isNaN(parseFloat(ae))){ae=parseFloat(ae);t=-ae/u.fps;O(ae);d=(t>0?1:-1)*Math.abs(d)}i=true;G()};this.destroy=function(){y();f.find("img").unbind().removeData();f.unbind();j(false);ab(false);c(window).unbind("scroll",L);f.images_settings=null;f.removeData(a)};C()}var a="panorama";c.fn[a]=function(e){if(this.length==0){return false}var f=arguments[0];if(typeof f==="string"){var d=c(this);var g=d.data(a);if(typeof g[e]==="function"){var h=Array.prototype.slice.call(arguments,1);return g[e].apply(d[0],h)}}else{if(typeof e==="object"||!e){return this.each(function(){var i=c(this);var j=i.data(a);if(typeof e==="object"||!e){return i.data(a,new b(i,e))}})}}}})(jQuery);