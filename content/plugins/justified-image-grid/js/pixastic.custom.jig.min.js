var Pixastic=function(){function b(a,b,f){a.addEventListener?a.addEventListener(b,f,!1):a.attachEvent&&a.attachEvent("on"+b,f)}function h(a){var k=!1,f=function(){k||(k=!0,a())};document.write('<script defer src="//:" id="__onload_ie_pixastic__">\x3c/script>');var d=document.getElementById("__onload_ie_pixastic__");d.onreadystatechange=function(){"complete"==d.readyState&&(d.parentNode.removeChild(d),f())};document.addEventListener&&document.addEventListener("DOMContentLoaded",f,!1);b(window,"load",
f)}function c(){for(var a=g("pixastic",null,"img"),b=g("pixastic",null,"canvas"),f=a.concat(b),d=0;d<f.length;d++)(function(){for(var a=f[d],b=[],k=a.className.split(" "),e=0;e<k.length;e++){var c=k[e];"pixastic-"==c.substring(0,9)&&(c=c.substring(9),""!=c&&b.push(c))}if(b.length)if("img"==a.tagName.toLowerCase())if(k=new Image,k.src=a.src,k.complete)for(k=0;k<b.length;k++)(e=Pixastic.applyAction(a,a,b[k],null))&&(a=e);else k.onload=function(){for(var k=0;k<b.length;k++){var d=Pixastic.applyAction(a,
a,b[k],null);d&&(a=d)}};else setTimeout(function(){for(var k=0;k<b.length;k++){var d=Pixastic.applyAction(a,a,b[k],null);d&&(a=d)}},1)})()}function g(a,b,f){var d=[];null==b&&(b=document);null==f&&(f="*");b=b.getElementsByTagName(f);f=b.length;a=new RegExp("(^|\\s)"+a+"(\\s|$)");for(j=i=0;i<f;i++)a.test(b[i].className)&&(d[j]=b[i],j++);return d}function m(a,b){if(Pixastic.debug)try{switch(b){case "warn":console.warn("Pixastic:",a);break;case "error":console.error("Pixastic:",a);break;default:console.log("Pixastic:",
a)}}catch(f){}}"undefined"!=typeof pixastic_parseonload&&pixastic_parseonload&&h(c);var e=function(){var a=document.createElement("canvas"),b=!1;try{b=!("function"!=typeof a.getContext||!a.getContext("2d"))}catch(f){}return function(){return b}}(),l=function(){var a=document.createElement("canvas"),b=!1,f;try{"function"==typeof a.getContext&&(f=a.getContext("2d"))&&(b="function"==typeof f.getImageData)}catch(d){}return function(){return b}}(),n=function(){var a=!1,b=document.createElement("canvas");
if(e()&&l()){b.width=b.height=1;b=b.getContext("2d");b.fillStyle="rgb(255,0,0)";b.fillRect(0,0,1,1);var f=document.createElement("canvas");f.width=f.height=1;var d=f.getContext("2d");d.fillStyle="rgb(0,0,255)";d.fillRect(0,0,1,1);b.globalAlpha=.5;b.drawImage(f,0,0);a=255!=b.getImageData(0,0,1,1).data[2]}return function(){return a}}();return{parseOnLoad:!1,debug:!1,applyAction:function(a,b,f,d){d=d||{};var e="canvas"==a.tagName.toLowerCase();if(e&&Pixastic.Client.isIE())return Pixastic.debug&&m("Tried to process a canvas element but browser is IE."),
!1;var c,g,n=!1;Pixastic.Client.hasCanvas()&&(n=!!d.resultCanvas,c=d.resultCanvas||document.createElement("canvas"),g=c.getContext("2d"));var h=a.offsetWidth,l=a.offsetHeight;e&&(h=a.width,l=a.height);if(0==h||0==l)if(null==a.parentNode){var r=a.style.position,u=a.style.left;a.style.position="absolute";a.style.left="-9999px";document.body.appendChild(a);h=a.offsetWidth;l=a.offsetHeight;document.body.removeChild(a);a.style.position=r;a.style.left=u}else{Pixastic.debug&&m("Image has 0 width and/or height.");
return}"blurfast"!==f&&"undefined"!==typeof d.retinaReady&&"yes"===d.retinaReady&&"undefined"!==typeof d.devicePixelRatio&&(h=Math.floor(h*d.devicePixelRatio),l=Math.floor(l*d.devicePixelRatio),"undefined"!==typeof a.naturalWidth&&"undefined"!==typeof a.naturalHeight&&0<a.naturalWidth&&0<a.naturalHeight&&(h>a.naturalWidth||l>a.naturalHeight)&&(h=a.naturalWidth,l=a.naturalHeight));if(-1<f.indexOf("(")&&(r=f,f=r.substr(0,r.indexOf("(")),r=r.match(/\((.*?)\)/),r[1]))for(r=r[1].split(";"),u=0;u<r.length;u++)if(thisArg=
r[u].split("="),2==thisArg.length)if("rect"==thisArg[0]){var v=thisArg[1].split(",");d[thisArg[0]]={left:parseInt(v[0],10)||0,top:parseInt(v[1],10)||0,width:parseInt(v[2],10)||0,height:parseInt(v[3],10)||0}}else d[thisArg[0]]=thisArg[1];d.rect?(d.rect.left=Math.round(d.rect.left),d.rect.top=Math.round(d.rect.top),d.rect.width=Math.round(d.rect.width),d.rect.height=Math.round(d.rect.height)):d.rect={left:0,top:0,width:h,height:l};r=!1;Pixastic.Actions[f]&&"function"==typeof Pixastic.Actions[f].process&&
(r=!0);if(!r)return Pixastic.debug&&m('Invalid action "'+f+'". Maybe file not included?'),!1;if(!Pixastic.Actions[f].checkSupport())return Pixastic.debug&&m('Action "'+f+'" not supported by this browser.'),!1;Pixastic.Client.hasCanvas()?(c!==a&&(c.width=h,c.height=l),n||(c.style.width=h+"px",c.style.height=l+"px"),g.drawImage(b,0,0,h,l),a.__pixastic_org_image?(c.__pixastic_org_image=a.__pixastic_org_image,c.__pixastic_org_width=a.__pixastic_org_width,c.__pixastic_org_height=a.__pixastic_org_height):
(c.__pixastic_org_image=a,c.__pixastic_org_width=h,c.__pixastic_org_height=l)):Pixastic.Client.isIE()&&"undefined"==typeof a.__pixastic_org_style&&(a.__pixastic_org_style=a.style.cssText);b={image:a,canvas:c,width:h,height:l,useData:!0,options:d};return Pixastic.Actions[f].process(b)?Pixastic.Client.hasCanvas()?(b.useData&&Pixastic.Client.hasCanvasImageData()&&(c.getContext("2d").putImageData(b.canvasData,d.rect.left,d.rect.top),c.getContext("2d").fillRect(0,0,0,0)),d.leaveDOM||(c.title=a.title,c.imgsrc=
a.imgsrc,e||(c.alt=a.alt),e||(c.imgsrc=a.src),c.className=a.className,c.style.cssText=a.style.cssText,c.name=a.name,c.tabIndex=a.tabIndex,c.id=a.id,a.parentNode&&a.parentNode.replaceChild&&a.parentNode.replaceChild(c,a)),d.resultCanvas=c):a:!1},prepareData:function(a,b){var c=a.canvas.getContext("2d"),d=a.options.rect,c=c.getImageData(d.left,d.top,d.width,d.height),d=c.data;b||(a.canvasData=c);return d},process:function(a,b,c,d){if("img"==a.tagName.toLowerCase()){var e=new Image;e.src=a.src;if(e.complete){var g=
Pixastic.applyAction(a,e,b,c);d&&d(g,a);return g}e.onload=function(){var g=Pixastic.applyAction(a,e,b,c);d&&d(g,a)}}if("canvas"==a.tagName.toLowerCase())return g=Pixastic.applyAction(a,a,b,c),d&&d(g,a),g},revert:function(a){if(Pixastic.Client.hasCanvas()){if("canvas"==a.tagName.toLowerCase()&&a.__pixastic_org_image)return a.width=a.__pixastic_org_width,a.height=a.__pixastic_org_height,a.getContext("2d").drawImage(a.__pixastic_org_image,0,0),a.parentNode&&a.parentNode.replaceChild&&a.parentNode.replaceChild(a.__pixastic_org_image,
a),a}else Pixastic.Client.isIE()&&"undefined"!=typeof a.__pixastic_org_style&&(a.style.cssText=a.__pixastic_org_style)},Client:{hasCanvas:e,hasCanvasImageData:l,hasGlobalAlpha:n,isIE:function(){return!!document.all&&!!window.attachEvent&&!window.opera}},Actions:{}}}();
"undefined"!=typeof jQuery&&jQuery&&jQuery.fn&&(jQuery.fn.pixastic=function(b,h){var c=[];this.each(function(){if("img"!=this.tagName.toLowerCase()||this.complete){var g=Pixastic.process(this,b,h);g&&c.push(g)}});return 0<c.length?jQuery(c):this});
Pixastic.Actions.blurfast={process:function(b){var h=parseFloat(b.options.amount)||0,c=!(!b.options.clear||"false"==b.options.clear),h=Math.max(0,Math.min(5,h));if(Pixastic.Client.hasCanvas()){var g=b.options.rect,m=b.canvas.getContext("2d");m.save();m.beginPath();m.rect(g.left,g.top,g.width,g.height);m.clip();var e=Math.round(b.width/2),l=Math.round(b.height/2),n=document.createElement("canvas");n.width=e;n.height=l;for(var c=!1,h=Math.round(20*h),a=n.getContext("2d"),k=0;k<h;k++){var f=Math.max(1,
Math.round(e-k)),d=Math.max(1,Math.round(l-k));a.clearRect(0,0,e,l);a.drawImage(b.canvas,0,0,b.width,b.height,0,0,f,d);c&&m.clearRect(g.left,g.top,g.width,g.height);m.drawImage(n,0,0,f,d,0,0,b.width,b.height)}m.restore();b.useData=!1;return!0}if(Pixastic.Client.isIE())return c=10*h,b.image.style.filter+=" progid:DXImageTransform.Microsoft.Blur(pixelradius="+c+")",b.image.style.marginLeft=(parseInt(b.image.style.marginLeft,10)||0)-Math.round(c)+"px",b.image.style.marginTop=(parseInt(b.image.style.marginTop,
10)||0)-Math.round(c)+"px",!0},checkSupport:function(){return Pixastic.Client.hasCanvas()||Pixastic.Client.isIE()}};
Pixastic.Actions.desaturate={process:function(b){var h=!(!b.options.average||"false"==b.options.average);if(Pixastic.Client.hasCanvasImageData()){var c=Pixastic.prepareData(b);b=b.options.rect;b=b.width*b.height;var g=4*b,m,e;if(h)for(;b--;)c[g-=4]=c[m=g+1]=c[e=g+2]=(c[g]+c[m]+c[e])/3;else for(;b--;)c[g-=4]=c[m=g+1]=c[e=g+2]=.3*c[g]+.59*c[m]+.11*c[e];return!0}if(Pixastic.Client.isIE())return b.image.style.filter+=" gray",!0},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE()}};
Pixastic.Actions.glow={process:function(b){var h=parseFloat(b.options.amount)||0,c=parseFloat(b.options.radius)||0,h=Math.min(1,Math.max(0,h)),c=Math.min(5,Math.max(0,c));if(Pixastic.Client.hasCanvasImageData()){var g=b.options.rect,m=document.createElement("canvas");m.width=b.width;m.height=b.height;var e=m.getContext("2d");e.drawImage(b.canvas,0,0);var l=Math.round(b.width/2),n=Math.round(b.height/2),a=document.createElement("canvas");a.width=l;a.height=n;for(var c=Math.round(20*c),k=a.getContext("2d"),
f=0;f<c;f++){var d=Math.max(1,Math.round(l-f)),q=Math.max(1,Math.round(n-f));k.clearRect(0,0,l,n);k.drawImage(m,0,0,b.width,b.height,0,0,d,q);e.clearRect(0,0,b.width,b.height);e.drawImage(a,0,0,d,q,0,0,b.width,b.height)}e=Pixastic.prepareData(b);b=Pixastic.prepareData({canvas:m,options:b.options});g=g.width*g.height;m=4*g;l=m+1;for(n=m+2;g--;)255<(e[m-=4]+=h*b[m])&&(e[m]=255),255<(e[l-=4]+=h*b[l])&&(e[l]=255),255<(e[n-=4]+=h*b[n])&&(e[n]=255);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.laplace={process:function(b){var h=!(!b.options.invert||"false"==b.options.invert),c=parseFloat(b.options.edgeStrength)||0,g=parseInt(b.options.greyLevel)||0,c=-c;if(Pixastic.Client.hasCanvasImageData()){var m=Pixastic.prepareData(b),e=Pixastic.prepareData(b,!0),l=b.options.rect;b=l.width;var l=l.height,n=4*b,a=l;do{var k=(a-1)*n,f=(1==a?0:a-2)*b*4,d=(a==l?a-1:a)*b*4,q=b;do{var s=k+(4*q-4),p=f+4*(1==q?0:q-2),t=d+4*(q==b?q-1:q),p=(.125*(-e[p-4]-e[p]-e[p+4]-e[s-4]-e[s+4]-e[t-4]-e[t]-
e[t+4]+8*e[s])+.125*(-e[p-3]-e[p+1]-e[p+5]-e[s-3]-e[s+5]-e[t-3]-e[t+1]-e[t+5]+8*e[s+1])+.125*(-e[p-2]-e[p+2]-e[p+6]-e[s-2]-e[s+6]-e[t-2]-e[t+2]-e[t+6]+8*e[s+2]))/3+g;0!=c&&(127<p?p+=(p+1-128)*c:127>p&&(p-=(p+1)*c));h&&(p=255-p);0>p&&(p=0);255<p&&(p=255);m[s]=m[s+1]=m[s+2]=p}while(--q)}while(--a);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};
Pixastic.Actions.sepia={process:function(b){var h=parseInt(b.options.mode,10)||0;0>h&&(h=0);1<h&&(h=1);if(Pixastic.Client.hasCanvasImageData()){var c=Pixastic.prepareData(b),g=b.options.rect;b=g.width;var m=4*b,g=g.height;do{var e=(g-1)*m,l=b;do{var n=e+4*(l-1);if(h)var a=.299*c[n]+.587*c[n+1]+.114*c[n+2],k=a+39,f=a+14,a=a-36;else var a=c[n],d=c[n+1],q=c[n+2],k=.393*a+.769*d+.189*q,f=.349*a+.686*d+.168*q,a=.272*a+.534*d+.131*q;0>k&&(k=0);255<k&&(k=255);0>f&&(f=0);255<f&&(f=255);0>a&&(a=0);255<a&&
(a=255);c[n]=k;c[n+1]=f;c[n+2]=a}while(--l)}while(--g);return!0}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()}};